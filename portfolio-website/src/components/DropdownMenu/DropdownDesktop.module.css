/**
 * Desktop Dropdown Menu Styles
 * 
 * A horizontal navigation menu with nested dropdowns that:
 * - Uses hover interactions
 * - Features smooth transitions
 * - Has distinct styling for different menu levels
 * - Includes interactive backgrounds and hover effects
 * 
 * Variables Used:
 * --number-cornerRadius: Border radius for menu items
 * --color-link: Primary color for level 0 items
 * --color-bg1: Text color for submenu items
 * --effect-poolShadow: Shadow effect for active menus
 * --opening/closing-dropdown: Transition timing variables
 */

/* Base Elements
   ------------ */
  .mainNav {
    display: flex;
  }

  .menuItem {
    width: fit-content;
    height: fit-content;
    position: relative;
    z-index: 1;
  
    &:hover { z-index: 2; }  /* Ensures dropdowns appear above siblings */
  }
  
  /* Phantom Element
     Maintains space in document flow while wrapper is absolute positioned */
  .phantom {
    visibility: hidden;
    height: var(--num-m12);  /* Matches height of menu items */
  }
  
  /* Wrapper Styling
     Provides container for menu item and its submenu */
  .wrapper {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);  /* Centers wrapper over phantom */
    width: max-content;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--num-m2);
    border: 0px solid transparent;
    border-style: inset;
    border-radius: var(--number-cornerRadius);
  
    /* Background effect layer */
    &::before {
      content: '';
      position: absolute;
      top: calc(-1 * var(--num-m2));
      left: calc(-1 * var(--num-m2));
      right: calc(-1 * var(--num-m2));
      bottom: calc(-1 * var(--num-m2));
      border-radius: var(--number-cornerRadius);
      z-index: -1;
      opacity: 0;
      transform: translateY(calc(-1 * var(--num-m1)));
      transition: var(--opening-dropdown);
    }
  }
  
  /* Menu Controls (Buttons & Links)
     ----------------------------- */
  .menuButton,
  .menuLink {
    /* Base layout */
    padding: var(--num-m2) var(--num-m4);
    display: flex;
    align-items: center;
    position: relative;
    overflow: hidden;
  
    /* Visual styling */
    background-color: transparent;
    border: inherit;
    border-style: inherit;
    border-radius: var(--number-cornerRadius);
    white-space: nowrap;
    text-decoration: none;
    transition: var(--menuControl-active);
  
    /* Text styling */
    span {
      position: relative;
      transition: var(--menuControl-hover), var(--menuControl-active);
    }
  
    /* Hover/active background effect */
    &::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: var(--number-cornerRadius);
      transition: var(--menuControl-hover);
      transform-origin: top;
      transform: scaleY(0);
      background-color: var(--col-ui-bg1-hover);
    }
  
    /* Interactive states */
    &.menuButtonActive,
    &.menuLinkActive {
      &::before { 
        transform: scaleY(1); 
        background-color: var(--col-ui-bg1-active);
      }
      span { color: var(--col-ui-nav1-active); }
    }
  
    &:hover {
      &::before { 
        transform: scaleY(1); 
        background-color: var(--col-ui-bg1-hover);
      }
      span { color: var(--col-ui-nav1-hover); }
    }
  
    /* Click animation */
    &:active {
      transform: scale(92%);
      span { transform: scale(108.7%); /* Counteracts parent scale */ }
      &::before { background-color: var(--col-ui-bg1-active); }
    }
  }
  
  /* Submenu Container
     --------------- */
  .submenuContainer {
    position: relative;
    width: max-content;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 0;
    overflow: hidden;
    opacity: 0;
    transform: translateY(calc(-1 * var(--num-m1)));
    transition: var(--closing-dropdown);
  
    .menuItem {
      width: 100%;
      display: flex;
      justify-content: center;
    }
  }
  
  /* Level 0 (Top Level) Styles
     ------------------------ */
  .menuLevel0 {
    display: flex;
    align-items: center;
    gap: 3rem;
  
    /* Special styling for top level items */
    .menuButton,
    .menuLink {
      span {
        color: var(--col-ui-nav2);
      }
    }
  
    /* Hover state */
    .menuButton:hover span,
    .menuLink:hover span {
      color: var(--col-ui-nav1-hover);
    }
  
    /* Active state */
    .menuButtonActive,
    .menuLinkActive {
      span {
        color: var(--col-ui-nav1-active);
      }
    }
  
    /* Background effect when active */
    .wrapper:has(.menuButtonActive),
    .wrapper:has(.menuLinkActive) {
      &::before {
        background-color: var(--col-ui-nav2);
        box-shadow: var(--effect-poolShadow);
        opacity: 1;
        transform: translateY(0);
        transition: var(--opening-dropdown);
      }
    }
  }
  
  /* Level 1+ (Submenu) Styles
     ----------------------- */
  .level1,
  .level2,
  .level3,
  .level4 {
    /* Text styling for submenu items */
    .menuButton span,
    .menuLink span {
      color: var(--col-ui-nav1);
    }
  
    /* Remove background from wrapper */
    .wrapper:has(.menuButtonActive)::before,
    .wrapper:has(.menuLinkActive)::before {
      background-color: transparent;
      box-shadow: none;
    }
  }
  
  /* Submenu Positioning
     ----------------- */
  .level1 .submenuContainer,
  .level2 .submenuContainer,
  .level3 .submenuContainer,
  .level4 .submenuContainer {
    position: absolute;
    right: calc(100% + 0.75rem);  /* Position to left with gap */
    top: 0;
  
    /* Invisible bridge for hover */
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 100%;
      width: var(--num-m4);
      height: 100%;
      background: transparent;
    }
    
    /* Background effect */
    &::before {
      content: '';
      position: absolute;
      top: calc(-1 * var(--num-m2));
      left: calc(-1 * var(--num-m2));
      right: calc(-1 * var(--num-m2));
      bottom: calc(-1 * var(--num-m2));
      border-radius: var(--number-cornerRadius);
      z-index: 1;
      background-color: var(--col-ui-bg1);
      box-shadow: var(--effect-poolShadow);
    }
  }
  
  /* Submenu Visibility
     ---------------- */
  .submenuVisible {
    overflow: visible;
    opacity: 1;
    transform: translateY(0);
    transition: var(--opening-dropdown);
  }